--CONSULTA 1

SELECT IDMEDICO,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/01/17' AND '31/12/17'
    THEN 1
    ELSE 0
  END) AS C_2017,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/01/18' AND '31/12/18'
    THEN 1
    ELSE 0
  END) AS C_2018,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/01/19' AND '31/12/19'
    THEN 1
    ELSE 0
  END) AS C_2019,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/01/17' AND '01/04/17'
    THEN 1
    ELSE 0
  END) AS T1_2017,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/04/17' AND '01/07/17'
    THEN 1
    ELSE 0
  END) AS T2_2017,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/07/17' AND '01/10/17'
    THEN 1
    ELSE 0
  END) AS T3_2017,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/10/17' AND '01/1/18'
    THEN 1
    ELSE 0
  END) AS T4_2017,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/01/18' AND '01/04/18'
    THEN 1
    ELSE 0
  END) AS T1_2018,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/04/18' AND '01/07/18'
    THEN 1
    ELSE 0
  END) AS T2_2018,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/07/18' AND '01/10/18'
    THEN 1
    ELSE 0
  END) AS T3_2018,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/10/18' AND '01/1/19'
    THEN 1
    ELSE 0
  END) AS T4_2018,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/01/19' AND '01/04/19'
    THEN 1
    ELSE 0
  END) AS T1_2019,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/04/19' AND '01/07/19'
    THEN 1
    ELSE 0
  END) AS T2_2019,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/07/19' AND '01/10/19'
    THEN 1
    ELSE 0
  END) AS T3_2019,
  SUM(
  CASE
    WHEN FECHA_CONSULTA BETWEEN '01/10/19' AND '01/1/20'
    THEN 1
    ELSE 0
  END)            AS T4_2019,
  COUNT(IDMEDICO) AS TOTAL_CONSULTAS
FROM MEDICO_CONSULTAR_PACIENTE
GROUP BY IDMEDICO

---------------------------------------------------------------------------------------